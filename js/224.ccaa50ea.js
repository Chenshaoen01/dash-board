"use strict";(self["webpackChunkdash_board2"]=self["webpackChunkdash_board2"]||[]).push([[224],{7224:function(o,t,e){e.r(t),e.d(t,{default:function(){return _o}});var l=e(3396),a=e(7139);const s={class:"container mt-5 mb-5"},d={class:"table border"},i=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{scope:"col"},"分類"),(0,l._)("th",{scope:"col"},"產品名稱"),(0,l._)("th",{scope:"col"},"原價"),(0,l._)("th",{scope:"col"},"售價"),(0,l._)("th",{scope:"col"},"是否啟用"),(0,l._)("th",{scope:"col"},"編輯")])],-1),n={key:0,class:"text-primary"},c={key:1,class:"text-muted"},r={class:"btn-group"},u=["onClick"],p=["onClick"];function m(o,t,e,m,h,_){const b=(0,l.up)("loading"),f=(0,l.up)("pageButton"),g=(0,l.up)("productModal"),v=(0,l.up)("Toast");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(b,{active:h.isLoading,"onUpdate:active":t[0]||(t[0]=o=>h.isLoading=o)},null,8,["active"]),(0,l._)("div",s,[(0,l._)("button",{type:"button",class:"btn btn-primary mb-3 d-flex ms-auto",onClick:t[1]||(t[1]=o=>_.openModal(!0))},"新增產品"),(0,l._)("table",d,[i,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(h.products,(o=>((0,l.wg)(),(0,l.iD)("tr",{key:o.id},[(0,l._)("td",null,(0,a.zw)(o.category),1),(0,l._)("td",null,(0,a.zw)(o.title),1),(0,l._)("td",null,(0,a.zw)(o.origin_price),1),(0,l._)("td",null,(0,a.zw)(o.price),1),(0,l._)("td",null,[o.is_enabled?((0,l.wg)(),(0,l.iD)("span",n,"已啟用")):((0,l.wg)(),(0,l.iD)("span",c,"未啟用"))]),(0,l._)("td",null,[(0,l._)("div",r,[(0,l._)("button",{type:"button",class:"btn btn-outline-primary",onClick:t=>_.openModal(o)},"編輯",8,u),(0,l._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>_.deleteProduct(o.id)},"刪除",8,p)])])])))),128))])]),(0,l.Wm)(f,{paginationReceived:h.pagination,onChangePage:_.getProducts},null,8,["paginationReceived","onChangePage"])]),(0,l.Wm)(g,{ref:"productModal",productsReceived:h.tempProduct,onSentData:_.updateData},null,8,["productsReceived","onSentData"]),(0,l.Wm)(v,{ref:"toast",class:"position-absolute top-0 end-0"},null,512)],64)}var h=e(9242);const _={class:"modal modal-xl",tabindex:"-1",id:"productModal"},b={class:"modal-dialog"},f={class:"modal-content my-auto"},g=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title"},"新增產品"),(0,l._)("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})],-1),v={class:"modal-body"},w={id:"productForm",class:"contianer needs-validation",novalidate:""},y={class:"row"},M={class:"col-lg-4 p-3"},k={class:"form-label w-100 mb-3"},x=(0,l._)("strong",null,"輸入圖片連結",-1),U={class:"form-label w-100 mb-3"},P=(0,l._)("strong",null,"或 上傳圖片",-1),D={type:"file",class:"form-control",ref:"imgInput"},C={class:"col-lg-8"},V={class:"row g-2 border-bottom p-2 mb-2"},L={class:"form-label col-md-6"},$=(0,l._)("strong",null,[(0,l.Uk)("標題"),(0,l._)("span",{class:"text-muted ms-1"},"*必填")],-1),q=(0,l._)("div",{class:"invalid-feedback"}," 此欄位為必填 ",-1),R={class:"form-label col-md-6"},S=(0,l._)("strong",null,"是否啟用",-1),H=(0,l._)("br",null,null,-1),N={class:"form-label col-md-6"},T=(0,l._)("strong",null,[(0,l.Uk)("分類"),(0,l._)("span",{class:"text-muted ms-1"},"*必填")],-1),z=(0,l._)("div",{class:"invalid-feedback"}," 此欄位為必填 ",-1),A={class:"form-label col-md-6"},E=(0,l._)("strong",null,[(0,l.Uk)("單位"),(0,l._)("span",{class:"text-muted ms-1"},"*必填")],-1),W=(0,l._)("div",{class:"invalid-feedback"}," 此欄位為必填 ",-1),Z={class:"form-label col-md-6"},B=(0,l._)("strong",null,[(0,l.Uk)("原價"),(0,l._)("span",{class:"text-muted ms-1"},"*必填")],-1),F=(0,l._)("div",{class:"invalid-feedback"}," 此欄位為必填 ",-1),I={class:"form-label col-md-6"},Y=(0,l._)("strong",null,[(0,l.Uk)("售價"),(0,l._)("span",{class:"text-muted ms-1"},"*必填")],-1),K=(0,l._)("div",{class:"invalid-feedback"}," 此欄位為必填 ",-1),j={class:"row g-1"},G={class:"form-label w-100"},J=(0,l._)("strong",null,"產品描述",-1),O={class:"form-label w-100"},Q=(0,l._)("strong",null,"說明內容",-1),X={class:"modal-footer"},oo=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function to(o,t,e,a,s,d){return(0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("div",b,[(0,l._)("div",f,[g,(0,l._)("div",v,[(0,l._)("form",w,[(0,l._)("div",y,[(0,l._)("div",M,[(0,l._)("label",k,[x,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":t[0]||(t[0]=o=>s.productModified.imageUrl=o)},null,512),[[h.nr,s.productModified.imageUrl]])]),(0,l._)("label",U,[P,(0,l._)("input",D,null,512)]),(0,l._)("button",{type:"button",class:"btn btn-outline-primary rounded-0 w-100",onClick:t[1]||(t[1]=(...o)=>d.imgUpload&&d.imgUpload(...o))},"新增圖片")]),(0,l._)("div",C,[(0,l._)("div",V,[(0,l._)("label",L,[$,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"請輸入標題",required:"","onUpdate:modelValue":t[2]||(t[2]=o=>s.productModified.title=o)},null,512),[[h.nr,s.productModified.title]]),q]),(0,l._)("label",R,[S,H,(0,l.wy)((0,l._)("input",{class:"form-check-input me-3",type:"checkbox",value:"1","onUpdate:modelValue":t[3]||(t[3]=o=>s.productModified.is_enabled=o)},null,512),[[h.e8,s.productModified.is_enabled]]),(0,l.Uk)("啟用 ")]),(0,l._)("label",N,[T,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"請輸入分類",required:"","onUpdate:modelValue":t[4]||(t[4]=o=>s.productModified.category=o)},null,512),[[h.nr,s.productModified.category]]),z]),(0,l._)("label",A,[E,(0,l.wy)((0,l._)("input",{type:"text",class:"form-control",placeholder:"請輸入單位",required:"","onUpdate:modelValue":t[5]||(t[5]=o=>s.productModified.unit=o)},null,512),[[h.nr,s.productModified.unit]]),W]),(0,l._)("label",Z,[B,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"請輸入原價",required:"","onUpdate:modelValue":t[6]||(t[6]=o=>s.productModified.origin_price=o)},null,512),[[h.nr,s.productModified.origin_price]]),F]),(0,l._)("label",I,[Y,(0,l.wy)((0,l._)("input",{type:"number",class:"form-control",placeholder:"請輸入售價",required:"","onUpdate:modelValue":t[7]||(t[7]=o=>s.productModified.price=o)},null,512),[[h.nr,s.productModified.price]]),K])]),(0,l._)("div",j,[(0,l._)("label",G,[J,(0,l.wy)((0,l._)("textarea",{class:"form-control",placeholder:"請輸入產品描述",cols:"30",rows:"2","onUpdate:modelValue":t[8]||(t[8]=o=>s.productModified.description=o)},null,512),[[h.nr,s.productModified.description]])]),(0,l._)("label",O,[Q,(0,l.wy)((0,l._)("textarea",{class:"form-control",placeholder:"請輸入說明內容",cols:"30",rows:"2","onUpdate:modelValue":t[9]||(t[9]=o=>s.productModified.content=o)},null,512),[[h.nr,s.productModified.content]])])])])])])]),(0,l._)("div",X,[oo,(0,l._)("button",{type:"submit",onClick:t[10]||(t[10]=(...o)=>d.confirm&&d.confirm(...o)),class:"btn btn-primary",form:"productForm"},"確認")])])])])}var eo=e(7972),lo=e.n(eo),ao={data(){return{productModal:{},productModified:{}}},props:["productsReceived"],watch:{productsReceived(){this.productModified=this.productsReceived}},methods:{modalShow(){console.log(this.productModal),this.productModal.show();const o=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(o).forEach((function(o){o.classList.remove("was-validated")}))},modalHide(){this.productModal.hide()},confirm(o){console.log("validation");const t=()=>{this.$emit("sentData",this.productModified)},e=document.querySelectorAll(".needs-validation");Array.prototype.slice.call(e).forEach((function(o){o.addEventListener("submit",(e=>{o.checkValidity()?(e.preventDefault(),t()):(e.preventDefault(),e.stopPropagation()),o.classList.add("was-validated")}),!1)}))},imgUpload(){const o=this.$refs.imgInput.files[0];console.dir(o);const t=new FormData;t.append("file-to-upload",o);const e="https://vue3-course-api.hexschool.io/api/chenshaoen/admin/upload";this.axios.post(e,t).then((o=>{console.log(o),o.data.sucess&&(this.productModified.imageUrl=o.data.imageUrl)}))}},mounted(){this.productModal=new(lo())(document.getElementById("productModal"))},created(){}},so=e(89);const io=(0,so.Z)(ao,[["render",to]]);var no=io,co=e(5513),ro=e.n(co),uo=e(4138),po=e(2327),mo={data(){return{products:[],tempProduct:{},isNew:!0,isLoading:!1,pagination:{}}},components:{productModal:no,Loading:ro(),pageButton:uo.Z,Toast:po.Z},methods:{getProducts(o=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/chenshaoen/admin/products?page=${o}`;this.axios.get(t).then((o=>{this.isLoading=!1,this.products=o.data.products,this.pagination=o.data.pagination}))},openModal(o){!0===o?(this.isNew=!0,this.tempProduct={}):(this.isNew=!1,this.tempProduct=o),this.$refs.productModal.modalShow()},openToast(o,t){console.log(o,t),this.$refs.toast.toastShow(o,t)},updateData(o){if(!0===this.isNew){this.$refs.productModal.modalHide();const t={data:o},e="https://vue3-course-api.hexschool.io/api/chenshaoen/admin/product";this.axios.post(e,t).then((o=>{console.log(o),this.openToast(o.data.success,o.data.message),this.getProducts()}))}else if(!1===this.isNew){this.$refs.productModal.modalHide();const t={data:o},e=`https://vue3-course-api.hexschool.io/api/chenshaoen/admin/product/${o.id}`;console.log(t),console.log(e),this.axios.put(e,t).then((o=>{console.log(o),this.openToast(),this.getProducts()}))}},deleteProduct(o){const t=`https://vue3-course-api.hexschool.io/api/chenshaoen/admin/product/${o}`;console.log(t),this.axios.delete(t).then((o=>{console.log(o),this.getProducts()}))}},created(){this.getProducts()}};const ho=(0,so.Z)(mo,[["render",m]]);var _o=ho}}]);
//# sourceMappingURL=224.ccaa50ea.js.map